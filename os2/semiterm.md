# OS2 R1年度 前期末
## 1 語句
ねのさぬ
とちすき
くなけに
てBDE
はあGい
うIたえ
おかつそ
こせ

## FAT fs
1. ファイルSAMPLE.DATが使用しているデータ領域をクラスタ番号で
  * 0x0006
  * "SAMPLE  .DAT"のClsを見ると、0x0006と書いてある。FATの0x0006の値は0xffff (終了)なので答えは0x0006。

2. ファイルABCDEFGH.TXTが使用しているデータ領域をクラスタ番号で
  * Clsは0x0002。FAT[0x0002]は0x0005、次にFAT[0x0005]は0x0004、そしてFAT[0x0004]は0xffff（終了）なので、答えは0x0002, 0x0005, 0x0004。

3. ABCDEFGH.TXTのサイズをKiBで
  * ABCDEFGH.TXTは0x0002,0x0005,0x0004の3つのクラスタを使っている。また、Sizeが400なので、最後のクラスタは400×512B使っている。1クラスタ32KiBなので、32KiB×2＋400×512B=66KiB。

4. FATを変更せずにABCDEFGH.TXTは何KiBまで大きくできるか
  * クラスタを3つ使えるので、32KiB×3=96KiB。

5. ディレクトリエントリのサイズは32B。ルートディレクトリを格納するのに必要なセクタ数は?
  * 512×32B=512B×32、答えは32セクタ。

6. このファイルシステムにはABCDEFGH.TXT,SAMPLE.DAT以外のファイルは格納されているか
  * ない。2番目のFileNameが0x00から始まっているのでそれ以降存在しないことを示している。

## 3 UFS
1. ブロックサイズ2KiBのとき、サイズが10KiBのファイルにはi-nodeの直接ブロックフィールドが何個必要か
  * 10KiB/2Kib=5(個)
2. ブロックサイズ2KiBのとき、1重間接ブロックは何バイトを超えるファイルから使用されるか
  * 2KiB×12=24KiB
3. ブロックサイズ2KiBのとき、1重間接ブロックを使うと新たに管理できるようになるブロックの個数は
  * 2KiB/4B=512(個)
4. ブロックサイズ2KiBのとき、新たに管理できるデータブロック全体で何バイトのデータを格納できるか
  * 2KiB×512=1MiB
5. ブロックサイズが2倍になると、3.のブロック数は何倍になるか
  * 2倍
6. 4.は何倍になるか
7. 1TiB(2^40B)のファイルを表現するにはブロックサイズは最小で何バイト必要か。ただし、ブロックサイズは2^Nバイトとする（ヒント：3重間接で管理できるブロック数は直接、1重、2重と比べると非常に大きいので、3重のときだけ考えれば良い）
  * ブロックサイズを2^Nとおくと、間接ブロックに入るデータブロック個数は2^N/4=2^(N-2)
  * 3重間接ブロックでき管理できるデータは2^(N-2)×2^(N-2)×2^(N-2)×2^N=2^(4N-6)=2^40
  * 4N-6=40、N=11.5、切り上げて12
  * よって、ブロックサイズは2^12B=4KiB
