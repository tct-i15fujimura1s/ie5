---
mathjax: true
---

{% include mathjax.html %}

# 数値計算誤差

## 今週の目標
数値計算で生じる誤差について説明できる。

## 数値計算とは
計算には2種類ある。

* 数値計算: 数値だけを使って計算する。無限桁の値は四捨五入する。
* 理論計算: 文字を使って計算する。

　数値計算はコンピュータを使って計算をする。理論計算は簡単な式では楽に解けるが、複雑な方程式などは人の手には余る。

　しかし、コンピュータを使っても理論計算の式では計算量が大きすぎる場合がある。たとえばクラメルの公式で10元連立１次方程式を解こうとすると、約36,000,000回の乗除算が必要になり、精度も落ちる。

　そのような場合、数値計算の結果は信頼できなくなる。数値計算では有限桁を取り扱うため誤差(error)が生じるが、繰り返しの回数が多い場合、真の値との誤差が無視できなくなる。

## 基数変換と誤差
　コンピュータで計算するとき、小数の単純な四則演算でも誤差が生じる場合がある。たとえば、$0.1+0.2=0.30000000000000004$になったりする。これは、計算時に発生する基数変換が原因である。

　基数変換で誤差が出る原因は、循環小数である。コンピュータは内部で2進数を使っているが、無限桁の計算をできないので、10進数では有限桁でも2進数では無限桁になるような場合切り落としてしまう。$0.2$は2進数では$0.001100110011\ldots_2$になる。

### 絶対誤差
真の値$a$、その近似値$x$とする。このとき$e=x-a$を誤差という。誤差の絶対値$\vert e\vert=\vert x-a \vert$を絶対誤差という。

### 相対誤差
$\vert e\vert$が小さい値（たとえば$1\times10^{-7}$）であっても、対象とする値が1.0であるときと$1\times10^{-8}$であるときでは、近似の程度には大きな違いがある。

* $x = 1.0\quad \vert e \vert = 10^{-7}$ ⇒ xは真の値と少なくとも6桁正しい
* $x = 1.0\times10^{-8} \quad \vert e \vert = 10^{-7}$ ⇒ aの最初の桁さえ決まらない

そこで、近似の程度を以下の式で表し、相対誤差という。

$$ e_R = \frac{e}{a} = \frac{x-a}{a} \approx \frac{e}{x} $$

### 例
270cmの柱を1cmの1/2まで測る大工と、1cmのネジを1cmの1/100まで測る旋盤工と、どちらがより正確に測ったといえるか。

相対誤差は、大工$e_R = \frac{0.5}{270} \approx 0.00185$、旋盤工$e_R=\frac{0.01}{1} = 0.0100$

この場合、大工の方が相対誤差が小さいので、270cmの柱を1cmの1/2まで測る大工の方が正確に測ったといえる。

---

なんらかの方法で絶対誤差がある$\varepsilon$より小さいことがわかった時、$\vert e \vert \le \varepsilon$ この$\varepsilon$を **誤差の限界** という。

## 数値計算誤差の種類
* 打切り誤差: 桁を途中で打ち切って近似値としたときの誤差
* 丸め誤差: 四捨五入、切り捨て、切り上げに伴う誤差
  * 計算機内で丸め誤差が生じない演算は、整数か、2進数の桁数が仮数部に入り切る値だけ
* 桁落ち: 絶対値のほぼ等しい2つの値の演算のときの誤差
  * $0.1234 - 0.1233 = 0.0001$ このとき有効数字が3桁失われている
* 情報落ち: 絶対値の大きな数値と小さな数値を計算した時小さな数値が無視される
* オーバーフロー: コンピュータで表現できる最大絶対値を超えるとき
* アンダーフロー: コンピュータで表現できる最小絶対値より小さくなるとき
