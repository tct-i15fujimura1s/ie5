{% include mathjax.html %}
# 数値解析 12/23
* 数値積分

## 面積を（近似的に）求める
* 図形に分割してその面積の和を計算する
* 分割の仕方が大きく分けて２つ
  * 台形公式: 1次関数で近似
  * シンプソンの積分公式: 2次関数で近似

### 台形公式
それぞれの区間での$f(x)$の値を1次関数で近似すると、分割した図形は台形になる。

高さ$k$、上底$a$、下底$b$の台形の面積の公式
$$ S = \frac{k(a+b)}{2}
を使って面積を求める。
このとき、

<div> $$ \\begin{eqnarray*}
S_k + S_{k+1} &=& \\frac{h}{2}(f(x_k)+f(x_{k+1})) + \\frac{h}{2}(f(x_{k+1})+f(x_{k+2})) \\
&=& \\frac{h}{2}(f(x_k)+2f(x_{k+1})+f(x_{k+2})
\\end{eqnarray*} $$ </div>

を使って、面積の公式は

$$
S = h\\left( \\frac{y_0 + y_N}{2} + \\sum_{k=1}^{N-1} y_k \\right)
$$

となる。

* 分割数を多くすると、近似した関数は元の関数に近くなり、精度が上がる。
* 求めた近似値が必要な精度に達するまで再計算する。
  0. $h_n = \frac{H}{2^n}$ とする
  1. <span> $S_0 = H_0 \\frac{f(a)+f(b)}{2}$
  2. $S_1 = H_1 \\left\\{ \\frac{f(a)+f(a+H_1)}{2} + \\frac{f(a+H_1) + f(b)}{2} \\} = \frac{S_0}{2} + H_1 f(a + H_1)$ </span>
  3. <span> $S_2 = \frac{S_1}{2} + H_2 \\left\\{ f(a+H_2) + f(a+3H_2) \\right\\}$ </span>
* 定式化

<div> $$
S_k = \frac12 S_{k-1} + \frac{H}{2^k} \sum_{i=奇数}^{2^k-1} f(a+\frac{iH}{2^k})
$$ </div>

### シンプソンの積分公式
* 区間$[a,b]$を$2N$等分し、それぞれの区間における$f(x)$を、前の区間、この区間、次の区間のそれぞれの始点を通る2次関数で近似する
